{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container bg-container-dark text-light">
    <div class="row">
        <div class="col-12 col-md-10 text-center text-md-left my-1">
            <h2><strong>Balloon Printing</strong></h2>
        </div>
    </div>
    <hr class="bg-light">
    {% if selector_form %}
        <div class="row">
            <div class="col-10 offset-1">
                <form action="{% url 'new_order_handler' %}" method="GET" id="selector-form">
                    {{ selector_form|crispy }}
                    {% if cntxt == 'add' %}
                        <button type="submit" class="d-none" id="selector-btn"></button>
                    {% else %}
                        <button type="submit" class="d-none disabled" id="selector-btn"></button>
                    {% endif %}
                </form>
            </div>
        </div>
    {% endif %}
    {% if order_form %}
        <hr class="bg-light">
        <div class="row">
            <div class="col-10 offset-1">
                <form action="{% url 'new_order_handler' %}" method="POST" id="order-form">
                    {% csrf_token %}
                    {{ order_form|crispy }}
                    {% if cntxt == 'add' %}
                        <button type="submit" class="btn btn-warning">submit</button>
                    {% else %}
                        <button type="submit" formaction="{% url 'update_order_handler' custom_print_order.id %}" class="btn btn-warning">update order</button>
                    {% endif %}
                    <input type="hidden" name="p_id" value="{{ product.id }}">
                </form>
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}

{% block postloadjs %}
{{ block.super }}

<script> 

    $('#selector-form').find('select').first().change(function() {
        var index = $(this).val();
        $('input[name="p_id"]').prop('value', index);

        if(!($('#selector-btn').hasClass('disabled'))) {
            $('#selector-btn').trigger('click');
        }
    });

</script>
{% endblock %}